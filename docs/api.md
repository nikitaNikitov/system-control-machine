# Документация по работе с API

## Использование

В данный момент не требуется использовать какой-то ключ для взаимодействия с API, но он всегда может появиться, либо появиться стороние условия, поэтому следует чаще проверять данную документацию

Все методы выполняются по адресу `serverip:port/api/` и ниак иначе, оффициально брать информацию о пользователях и работать через сторонние автоматизированные программы можно только оттуда

## Методы

- [getUser](#--getuser)
- [qr](#--qr)

---------------

### - `getUser`

  Позволяет получить информацию о пользователе с помощью кода, который можно получить через QR код пользователя

#### Запрос

- `GET` -> getUser?code=code
- `POST` -> getUser

```json
  {
    "code": "code"
  }
  ```

#### Параметры

- `code` - Код пользователя
  
#### Ответ
  
  ```json
  {
    "username": "Username", 
    "fullname": "Full name", 
    "permissions": {}
  }
  ```

| Название      | Описание              |
| ------------- | --------------------- |
| `username`    | Никнейм пользователя  |
| `fullname`    | ФИО пользователя      |
| `permissions` | Права пользователя на различные станки (Пока они отсутствуют)  |

---------------

### - `qr`

  Позволяет получить QR код пользователя в текстовом виде

#### Запрос

- `GET` -> qr

#### Параметры

- Для данного метода необходима авторизация на сайте (готовые cookies["csrftoken", "sessionid"])

#### Ответ
  
  ```json
  {
    "code": "code", 
    "time_start": 1676756720, 
    "time_expire": 1676757020
  }
  ```

| Название      | Описание              |
| ------------- | --------------------- |
| `code`        | Код QR кода           |
| `time_start`  | Время начала действия |
| `time_expire` | Время конца действия  |

## Ошибки при работе с API

При возникновения ошибки, которая обрабатывается кодом, будет отображаться в формате

```json
{
  "error": 1,
  "error_msg": "Описание ошибки"
}
```

| Номер ошибки | Описание ошибки                |
| ------------ | ------------------------------ |
| 1            | Неизвестная ошибка             |
| 10           | Пользователь не найден         |
| 101          | Код не был отправлен с клиента |
| 102          | Код отсутствует в базе данных  |
| 103          | Код пока не действителен, будет действителен через время |
| 104          | Код просрочен                  |
